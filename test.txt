===> Awaiting all services ready
gateway service is up and running at http://localhost:9500
===> Launch docker container running python integration script
------------------------------------------------------------------------------------------

=> Peuplement de la base de données Astronaut

Ajout de 11 astronautes
POST http://localhost:4311/astronaut
{"id_astronaut":1,"name":"Megan","isDead":false,"job":"Astronaute","planet":"Terre","location":"Zone d'embarquement","_id":"635d997131de379a18cd31a3"}
{"id_astronaut":2,"name":"Thomas","isDead":false,"job":"Astronaute","planet":"Terre","location":"Zone d'embarquement","_id":"635d997131de379a18cd31a6"}
{"id_astronaut":3,"name":"Samantha","isDead":false,"job":"Astronaute","planet":"Terre","location":"Zone d'embarquement","_id":"635d997131de379a18cd31a9"}
{"id_astronaut":4,"name":"Oleg","isDead":false,"job":"Astronaute","planet":"Terre","location":"Zone d'embarquement","_id":"635d997131de379a18cd31ac"}
{"id_astronaut":5,"name":"Peggy","isDead":false,"job":"Astronaute","planet":"Terre","location":"Zone d'embarquement","_id":"635d997131de379a18cd31af"}
{"id_astronaut":6,"name":"Buzz","isDead":false,"job":"Commandant de Moon Base","planet":"Lune","location":"Module de commandement de la base","_id":"635d997131de379a18cd31b2"}
{"id_astronaut":7,"name":"Ellen","isDead":false,"job":"Astronaute","planet":"Lune","location":"Modules de vie Nord","_id":"635d997131de379a18cd31b5"}
{"id_astronaut":8,"name":"Jim","isDead":false,"job":"Astronaute","planet":"Lune","location":"Modules d'analyse scientifique","_id":"635d997131de379a18cd31b8"}
{"id_astronaut":9,"name":"Kayla","isDead":false,"job":"Astronaute","planet":"Lune","location":"Modules de vie Sud","_id":"635d997131de379a18cd31bb"}
{"id_astronaut":10,"name":"Akihiko","isDead":false,"job":"Astronaute","planet":"Lune","location":"Zone d'exploration 1","_id":"635d997131de379a18cd31be"}
{"id_astronaut":11,"name":"Serguei","isDead":false,"job":"Astronaute","planet":"Lune","location":"Zone d'exploration 1","_id":"635d997131de379a18cd31c1"}

=> Peuplement de la base de données Module Life

Ajout de 4 modules
  - Inventaire de 32 provisions
  - Modules isolés : 1 (515) 
  - Modules en mauvaise situation : 2
  - Besoins de 8 provisions

POST http://localhost:4303/module
{"id_module":512,"type":"Module sécurisé","vitals":[{"pressure":1,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf2"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbdf3"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbdf4"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbdf5"}],"astronauts":[],"isolated":false,"_id":"635d99714988744b580cbdf1"}
{"id_module":513,"type":"Module de vie","vitals":[{"pressure":3,"co2_rate":80,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf9"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbdfa"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbdfb"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbdfc"}],"astronauts":[6,7,9,11],"isolated":false,"_id":"635d99714988744b580cbdf8"}
{"id_module":514,"type":"Module d'analyse scientifique","vitals":[{"pressure":3,"co2_rate":20,"co2_scrubbers_activated":false,"_id":"635d99714988744b580cbe00"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe01"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe02"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe03"}],"astronauts":[8,10],"isolated":false,"_id":"635d99714988744b580cbdff"}
{"id_module":515,"type":"Entrepot","vitals":[{"pressure":3,"co2_rate":75,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbe07"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe08"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe09"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe0a"}],"astronauts":[],"isolated":true,"_id":"635d99714988744b580cbe06"}

=> Peuplement de la base de données Spacesuit

Ajout d'une combinaison numéro 1 avec:
  - 20 de temperature
  - 3 de pression 
  - 80 de taux d'oxygene
  - 60 de rythme cardiaque

POST http://localhost:4306/module
{"id_spacesuit":1,"id_astronaut":null,"current_vitals":null,"_id":"635d99715cb8ae343a863cd4"}

=> Peuplement de la base de données Spacecraft

Ajout de 2 vaisseaux 2 avec:
  - des bonnes conditions matérielles 
  - status à PREPARING
  - aucune mission de ravitaillement lié

POST http://localhost:4305/spacecraft
{"id_spacecraft":1,"vitals":true,"status":"Au sol","id_resupplyMission":"None","id_rotationMissions":[],"_id":"635d9971b8525cb0bedb3bf6"}
{"id_spacecraft":2,"vitals":true,"status":"Au sol","id_resupplyMission":"None","id_rotationMissions":[],"_id":"635d9971b8525cb0bedb3bf9"}

=> Peuplement de la base de données Meteorite Monitoring

Ajout de 5 meteorites inoffensives
POST http://localhost:4308/meteorite
{"id_meteorite":1,"dangerous":false,"_id":"635d99715960d119ae0a9d5c"}
{"id_meteorite":2,"dangerous":false,"_id":"635d99715960d119ae0a9d5e"}
{"id_meteorite":3,"dangerous":false,"_id":"635d99715960d119ae0a9d60"}
{"id_meteorite":4,"dangerous":false,"_id":"635d99715960d119ae0a9d62"}
{"id_meteorite":5,"dangerous":false,"_id":"635d99715960d119ae0a9d64"}

=> Peuplement de la base de données Moon Base

Ajout d'une base lunaire 1 
POST http://localhost:4310/moon-base
{"id_base":1,"stock":[{"label":"saucisson","quantity":30,"_id":"635d99719e25dd76d6a70be9"},{"label":"pates","quantity":80,"_id":"635d99719e25dd76d6a70bea"},{"label":"eau","quantity":100,"_id":"635d99719e25dd76d6a70beb"}],"alarm_on":false,"modules":[512,513,514,515]}

--------------------------------- Start Integration Tests --------------------------------


---------------------- Scenario 1 ----------------------

=> Récupération des positions des astronautes sur la Lune via Astronaut Service
   US 17 : En tant que Deke, je veux connaitre la position de chaque astronaute sur la Lune
   On s'attend à trouver Buzz dans le module de commandement, Ellen et Kayla dans les modules de vie Nord et Sud, Jim dans le module d'analyse scientifique et Akihiko et Serguei en exploration dans la zone1
GET http://localhost:4311/onMoonAstronauts
Response : 
[{"_id":"635d997131de379a18cd31b2","id_astronaut":6,"name":"Buzz","isDead":false,"job":"Commandant de Moon Base","planet":"Lune","location":"Module de commandement de la base"},{"_id":"635d997131de379a18cd31b5","id_astronaut":7,"name":"Ellen","isDead":false,"job":"Astronaute","planet":"Lune","location":"Modules de vie Nord"},{"_id":"635d997131de379a18cd31b8","id_astronaut":8,"name":"Jim","isDead":false,"job":"Astronaute","planet":"Lune","location":"Modules d'analyse scientifique"},{"_id":"635d997131de379a18cd31bb","id_astronaut":9,"name":"Kayla","isDead":false,"job":"Astronaute","planet":"Lune","location":"Modules de vie Sud"},{"_id":"635d997131de379a18cd31be","id_astronaut":10,"name":"Akihiko","isDead":false,"job":"Astronaute","planet":"Lune","location":"Zone d'exploration 1"},{"_id":"635d997131de379a18cd31c1","id_astronaut":11,"name":"Serguei","isDead":false,"job":"Astronaute","planet":"Lune","location":"Zone d'exploration 1"}]

=> Récupérer les conditions de vie des modules via Survival Control Service 
   US 1 : En tant que Deke, je veux surveiller les conditions de vie de chaque module
   On s'attend à recevoir les vitals des 4 modules dont le 512 avec une pression insuffisante
GET http://localhost:4304/survival-control/supervision
Response : 
[{"id_module":512,"vitals":[{"pressure":1,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf2"}]},{"id_module":513,"vitals":[{"pressure":3,"co2_rate":80,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf9"}]},{"id_module":514,"vitals":[{"pressure":3,"co2_rate":20,"co2_scrubbers_activated":false,"_id":"635d99714988744b580cbe00"}]},{"id_module":515,"vitals":[{"pressure":3,"co2_rate":75,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbe07"}]}]

=> Isolement d'un module lunaire via Survival Control Service
   US 4 : En tant que Deke, je veux isoler le module 512 après avoir constaté une pression insuffisante
PUT http://localhost:4303/module/512/isolate
Response : 
Module isolé

=> Récupération des données d'un module lunaire via Module Life Service
   On veut s'assurer que le module 512 a bien été isolé 
   On s'attend à ce que le champ isolated du module 512 soit à true et qu'aucun astronaute ne se trouve à l'intérieur
GET http://localhost:4303/module/512
Response : 
{"_id":"635d99714988744b580cbdf1","id_module":512,"type":"Module sécurisé","vitals":[{"pressure":1,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf2"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbdf3"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbdf4"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbdf5"}],"astronauts":[],"isolated":true}

=> Récupération des données d'un module lunaire via Vitals Module
   US 9 : En tant que Jim, je veux que les épurateurs de CO2 s'activent et se désactivent en fonction des niveaux de CO2 dans les modules de la base, afin de garantir un air respirable sans risque pour l'équipage. Par exemple le 514
   On s'attend à ce que le champ co2_rate du module 514 soit à 20 
   On s'attend à ce que le champ co2_scrubbers_activated du module 514 soit à false car le taux de co2 est normal
GET http://localhost:4303/module/514
Response : 
{"_id":"635d99714988744b580cbdff","id_module":514,"type":"Module d'analyse scientifique","vitals":[{"pressure":3,"co2_rate":20,"co2_scrubbers_activated":false,"_id":"635d99714988744b580cbe00"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe01"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe02"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe03"}],"astronauts":[8,10],"isolated":false}

=> Changement du taux de co2 à 100 dans le module 514
PUT http://localhost:4303/module/514
{'id_module': 514, 'type': "Module d'analyse scientifique", 'astronauts': [8, 10], 'vitals': {'pressure': 3, 'co2_rate': 100, 'co2_scrubbers_activated': False}, 'supplies': [{'label': 'saucisson', 'quantity': 2}, {'label': 'pates', 'quantity': 5}, {'label': 'eau', 'quantity': 7}], 'isolated': True}
Response : 
{"_id":"635d99714988744b580cbdff","id_module":514,"type":"Module d'analyse scientifique","vitals":[{"pressure":3,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbe46"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe47"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe48"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe49"}],"astronauts":[8,10],"isolated":true}

=> Récupération des conditions de vie du module 514 via Module Life Service
   US 9 : En tant que Jim, je veux que les épurateurs de CO2 s'activent et se désactivent en fonction des niveaux de CO2 dans les modules de la base, afin de garantir un air respirable sans risque pour l'équipage. Par exemple le 514
   On veut s'assurer que l'épurateur d'air du module 514 s'est bien mis en marche
   On s'attend à ce que le champ co2_scrubbers_activated du module 514 soit à true car le taux de co2 a subitement augmenté et nécessite que les épurateurs fonctionnent
GET http://localhost:4303/module/514
Response : 
{"_id":"635d99714988744b580cbdff","id_module":514,"type":"Module d'analyse scientifique","vitals":[{"pressure":3,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbe46"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe47"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe48"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe49"}],"astronauts":[8,10],"isolated":true}

=> Récupération de l'analyse du danger en provenance de météorites via Meteorite Monitoring Service
   US 13 : En tant que Deke, je veux suivre les météorites autour de la Lune
   On s'attend à ce que réponse soit false en effet aucune météorite n'est classée comme dangereuse
GET http://localhost:4308/meteorite/danger
Response : 
false

=> Ajout d'une nouvelle météorite dans Meteorite Monitoring Service
   Un scientifique à détecter une nouvelle météorite qu'il considère comme dangereuse
   On s'attend à ce que la base lunaire s'isole
POST http://localhost:4308/meteorite
{'id_meteorite': 6, 'dangerous': True}
Response : 
{"id_meteorite":6,"dangerous":true,"_id":"635d99715960d119ae0a9d67"}

=> Petite attente pour récupérer l'event

=> Isolement de la base lunaire en cas de nuage de météorite
   US 14 : En tant que Deke, je veux faire sonner l'alarme de la base lunaire et isoler tous les modules en cas de détection d'un danger
   On s'attend à ce que le champ alarm_on de la base soit à true
GET http://localhost:4310/moon-base/1
Response : 
{"id_base":1,"stock":[{"label":"saucisson","quantity":30,"_id":"635d99719e25dd76d6a70be9"},{"label":"pates","quantity":80,"_id":"635d99719e25dd76d6a70bea"},{"label":"eau","quantity":100,"_id":"635d99719e25dd76d6a70beb"}],"alarm_on":true,"modules":[512,513,514,515]}

=> Vérification de l'isolement de tous les modules de la Lune
   On s'attend à ce que tous les modules soient isolés et que la position de tous les astronautes de la lune soient dans le module sécurisé
GET http://localhost:4303/module
Response : 
[{"astronauts":[6,7,9,11,8,10],"id_module":512,"type":"Module sécurisé","vitals":[{"pressure":1,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf2"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbdf3"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbdf4"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbdf5"}],"isolated":true},{"astronauts":[],"id_module":513,"type":"Module de vie","vitals":[{"pressure":3,"co2_rate":80,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbdf9"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbdfa"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbdfb"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbdfc"}],"isolated":true},{"astronauts":[],"id_module":514,"type":"Module d'analyse scientifique","vitals":[{"pressure":3,"co2_rate":100,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbe46"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe47"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe48"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe49"}],"isolated":true},{"astronauts":[],"id_module":515,"type":"Entrepot","vitals":[{"pressure":3,"co2_rate":75,"co2_scrubbers_activated":true,"_id":"635d99714988744b580cbe07"}],"supplies":[{"label":"saucisson","quantity":2,"_id":"635d99714988744b580cbe08"},{"label":"pates","quantity":5,"_id":"635d99714988744b580cbe09"},{"label":"eau","quantity":7,"_id":"635d99714988744b580cbe0a"}],"isolated":true}]

=> Vérification de la position des astronautes sur la Lune
   On s'attend à ce que la position de tous les astronautes de la Lune soient dans le module sécurisé
GET http://localhost:4311/onMoonAstronauts
Response : 
[{"_id":"635d997131de379a18cd31b2","id_astronaut":6,"name":"Buzz","isDead":false,"job":"Commandant de Moon Base","planet":"Lune","location":"Module sécurisé"},{"_id":"635d997131de379a18cd31b5","id_astronaut":7,"name":"Ellen","isDead":false,"job":"Astronaute","planet":"Lune","location":"Module sécurisé"},{"_id":"635d997131de379a18cd31b8","id_astronaut":8,"name":"Jim","isDead":false,"job":"Astronaute","planet":"Lune","location":"Module sécurisé"},{"_id":"635d997131de379a18cd31bb","id_astronaut":9,"name":"Kayla","isDead":false,"job":"Astronaute","planet":"Lune","location":"Module sécurisé"},{"_id":"635d997131de379a18cd31be","id_astronaut":10,"name":"Akihiko","isDead":false,"job":"Astronaute","planet":"Lune","location":"Module sécurisé"},{"_id":"635d997131de379a18cd31c1","id_astronaut":11,"name":"Serguei","isDead":false,"job":"Astronaute","planet":"Lune","location":"Module sécurisé"}]

---------------------------------- End Integration Tests ---------------------------------
